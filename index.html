<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ù†Ø¸Ø§Ù… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ ÙˆØ§Ù„Ø³Ø¹Ø±</title>
  <style>
    body { font-family: Arial; background: #f2f2f2; padding: 20px; max-width: 800px; margin: auto; border-radius: 10px; }
    input, button { padding: 10px; margin: 5px 0; width: 100%; font-size: 16px; }
    table { width: 100%; margin-top: 20px; border-collapse: collapse; background: white; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    #totals { margin-top: 20px; font-size: 18px; font-weight: bold; }
    .btns { display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap; }
    button { cursor: pointer; }
  </style>
</head>
<body>

  <h2>ğŸ§¾ Ù†Ø¸Ø§Ù… Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ ÙˆØ§Ù„Ø³Ø¹Ø±</h2>

  <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</label>
  <input type="text" id="fileName" placeholder="Ù…Ø«Ø§Ù„: Ù…Ù„Ù Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª">

  <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚:</label>
  <input type="number" id="pageCount" placeholder="Ù…Ø«Ø§Ù„: 12">

  <label>Ø³Ø¹Ø± Ø§Ù„ÙˆØ±Ù‚Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© (Ø¯ÙŠÙ†Ø§Ø±):</label>
  <input type="number" id="pricePerPage" value="100">

  <button onclick="addFile()">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù„Ù</button>

  <table id="dataTable">
    <thead>
      <tr>
        <th>Ø§Ù„Ø±Ù‚Ù…</th>
        <th>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù</th>
        <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚</th>
        <th>Ø§Ù„Ø³Ø¹Ø± (Ø¯ÙŠÙ†Ø§Ø±)</th>
        <th>âŒ</th>
      </tr>
    </thead>
    <tbody id="fileTable"></tbody>
  </table>

  <div id="totals">
    ğŸ“„ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚: 0<br>
    ğŸ’° Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¹Ø±: 0 Ø¯ÙŠÙ†Ø§Ø±
  </div>

  <div class="btns">
    <button onclick="printPage()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>
    <button onclick="exportToExcel()">ğŸ“¤ ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel</button>
    <button onclick="resetAll()">â™»ï¸ Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ÙƒÙ„</button>
  </div>

  <script>
    let data = JSON.parse(localStorage.getItem("fileData") || "[]");
    let index = 1;

    function updateDisplay() {
      const tbody = document.getElementById("fileTable");
      tbody.innerHTML = "";
      let totalPages = 0, totalPrice = 0;

      data.forEach((item, i) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${i + 1}</td>
          <td>${item.name}</td>
          <td>${item.pages}</td>
          <td>${item.price}</td>
          <td><button onclick="removeFile(${i})">ğŸ—‘ï¸</button></td>
        `;
        tbody.appendChild(row);
        totalPages += item.pages;
        totalPrice += item.price;
      });

      document.getElementById("totals").innerHTML = `
        ğŸ“„ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚: ${totalPages}<br>
        ğŸ’° Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¹Ø±: ${totalPrice} Ø¯ÙŠÙ†Ø§Ø±
      `;
      localStorage.setItem("fileData", JSON.stringify(data));
    }

    function addFile() {
      const name = document.getElementById("fileName").value;
      const pages = parseInt(document.getElementById("pageCount").value);
      const pricePerPage = parseInt(document.getElementById("pricePerPage").value);

      if (!name || isNaN(pages) || pages <= 0 || isNaN(pricePerPage) || pricePerPage <= 0) {
        alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.");
        return;
      }

      const filePrice = pages * pricePerPage;
      data.push({ name, pages, price: filePrice });
      updateDisplay();

      document.getElementById("fileName").value = '';
      document.getElementById("pageCount").value = '';
    }

    function removeFile(i) {
      if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„ÙØŸ")) {
        data.splice(i, 1);
        updateDisplay();
      }
    }

    function resetAll() {
      if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ")) {
        data = [];
        localStorage.removeItem("fileData");
        updateDisplay();
      }
    }

    function printPage() {
      window.print();
    }

    function exportToExcel() {
      let csv = "Ø§Ù„Ø±Ù‚Ù…,Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù,Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚,Ø§Ù„Ø³Ø¹Ø± (Ø¯ÙŠÙ†Ø§Ø±)\n";
      data.forEach((item, i) => {
        csv += `${i + 1},${item.name},${item.pages},${item.price}\n`;
      });

      const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ù…Ù„ÙØ§Øª.csv";
      a.click();
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­
    window.onload = updateDisplay;
  </script>

</body>
</html>
